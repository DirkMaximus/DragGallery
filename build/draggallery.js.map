{"version":3,"file":"draggallery.js","mappings":"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","sources":["webpack://drag-gallery/./src/draggallery.js"],"sourcesContent":["class DragGallery {\r\n\r\n\tconstructor() {\r\n\r\n\t\tthis.renderRows = this.renderRows.bind(this);\r\n\t\tthis.waitForImages = this.waitForImages.bind(this);\r\n\t\tthis.imgLoad = this.imgLoad.bind(this);\r\n\r\n\t\tjQuery(window).on('resize orientationchange', this.renderRows);\r\n\r\n\t\tjQuery(document).ready(this.waitForImages);\r\n\t\tjQuery(window).on('load', this.waitForImages);\r\n\r\n\t\tthis.waitForImages();\r\n\t}\r\n\r\n\twaitForImages() {\r\n\t\tconst self = this;\r\n\r\n\t\tjQuery('.drag-gallery img').each(function(index) {\r\n\t\t\t//if(!jQuery(this).data('imgLoadListening')) {\r\n\t\t\t\t//jQuery(this).data('imgLoadListening', true);\r\n\r\n\t\t\t\tjQuery(this).one(\"load\", self.imgLoad);\r\n\t\t\t\ttry {\r\n\t\t\t\t\tif(this.complete) jQuery(this).trigger('load');\r\n\t\t\t\t} catch (e) {\r\n\t\t\t\t\t//console.log(e);\r\n\t\t\t\t}\r\n\t\t\t//}\r\n\t\t});\r\n\t}\r\n\timgLoad(e) {\r\n\r\n\t\tconst gallery = jQuery(e.target).parents('.drag-gallery')[0];\r\n\r\n\t\tlet ready = true;\r\n\t\tjQuery(gallery).find('img').each(function(index) {\r\n\t\t\tif(!this.complete) {\r\n\t\t\t\tready = false;\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tif(ready) {\r\n\t\t\tjQuery(gallery).removeClass('loading');\r\n\r\n\t\t\tthis.renderRows();\r\n\t\t}\r\n\t}\r\n\r\n\tgetREM() {\r\n\t\treturn parseFloat(jQuery(':root').css('font-size').replace('px', ''));\r\n\t}\r\n\r\n\t/*\r\n\tGet an array of all image elements in a row\r\n\t@param gallery(element): .drag-gallery element\r\n\t@param row_num(int): if row_image is null, row_num can be used instead\r\n\t*/\r\n\tgetRow(gallery, row_num) {\r\n\r\n\t\tlet row_image_arr = new Array();\r\n\r\n\t\tlet images = jQuery(gallery).find('.image');\r\n\r\n\t\tfor(let i = 0; i < images.length; i++) {\r\n\t\t\tconst image = images[i];\r\n\r\n\t\t\tif(parseFloat(jQuery(image).attr('data-row')) == row_num) {\r\n\t\t\t\trow_image_arr.push(image);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn row_image_arr;\r\n\t}\r\n\r\n\trenderRows() {\r\n\r\n\t\tconst self = this;\r\n\r\n\t\tjQuery('.drag-gallery').each(function(index) {\r\n\t\t\tconst images = jQuery(this).find('.image');\r\n\r\n\t\t\t//Get all rows as arrays\r\n\t\t\tconst rows = new Array();\r\n\t\t\tfor(let i = 0; i < images.length; i++) {\r\n\r\n\t\t\t\tconst row_num = parseFloat(jQuery(images[i]).attr('data-row'));\r\n\r\n\t\t\t\tlet in_row = false;\r\n\t\t\t\tfor(let j = 0; j < rows.length; j++) {\r\n\t\t\t\t\tif(rows[j].row_num == row_num) {\r\n\t\t\t\t\t\tin_row = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(!in_row) {\r\n\t\t\t\t\trows.push({\r\n\t\t\t\t\t\trow_num: row_num,\r\n\t\t\t\t\t\timages: self.getRow(this, parseFloat(jQuery(images[i]).attr('data-row')))\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t//Render each row\r\n\t\t\tfor(let i = 0; i < rows.length; i++) {\r\n\t\t\t\tconst row = rows[i].images;\r\n\t\t\t\tself.renderRow(row);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\trenderRow(row) {\r\n\r\n\t\tif(row.length == 1) {\r\n\r\n\t\t\tconst image = row[0];\r\n\t\t\tconst gallery = jQuery(image).parents('.drag-gallery')[0];\r\n\t\t\tconst width = jQuery(image).parent().innerWidth() - this.getSpaceX(gallery);\r\n\t\t\tconst img = jQuery(image).find('img')[0];\r\n\t\t\t\r\n\t\t\tjQuery(image)\r\n\t\t\t.css('width', '')\r\n\t\t\t.css('flex-basis', '')\r\n\t\t\t.css('height', width * (img.naturalHeight / img.naturalWidth)+'px');\r\n\t\t\t\r\n\t\t} else {\r\n\r\n\t\t\tconst gallery = jQuery(row[0]).parents('.drag-gallery');\r\n\t\t\t//const cWidth = jQuery(gallery).find('.wrapper').innerWidth();\r\n\t\t\t\r\n\t\t\tconst wrapper = jQuery(gallery).find('.wrapper')[0];\r\n\t\t\tconst wrapper_rect = wrapper.getBoundingClientRect();\r\n\t\t\t\r\n\t\t\tconst cWidth = wrapper_rect.width;\r\n\r\n\t\t\t// Generate array containing all image aspect ratios\r\n\t\t\tvar ratios = row.map(function(image, i) {\r\n\t\t\t\t\r\n\t\t\t\tlet ratio = 0;\r\n\t\t\t\tconst img = jQuery(image).find('img')[0];\r\n\t\t\t\tif(img.naturalWidth && img.naturalHeight) ratio = img.naturalWidth / img.naturalHeight;\r\n\r\n\t\t\t\treturn ratio;\r\n\t\t\t});\r\n\r\n\t\t\t// Get sum of widths\r\n\t\t\tlet minRatio = Math.min.apply(Math, ratios);\r\n\t\t\tlet sumRatios = 0;\r\n\t\t\tfor(let i = 0; i < row.length; i++) {\r\n\t\t\t\tconst ratio = ratios[i];\r\n\t\t\t\tif(ratio != 0) sumRatios += ratio / minRatio;\r\n\t\t\t};\r\n\r\n\t\t\tlet sumMargins = row.length * this.getSpaceX(gallery);\r\n\r\n\t\t\t// Calculate dimensions\r\n\t\t\tif(sumRatios != 0) {\r\n\t\t\t\tfor(let i = 0; i < row.length; i++) {\r\n\t\t\t\t\tconst image = row[i];\r\n\t\t\t\t\tconst minWidth = (cWidth - sumMargins) / sumRatios;\r\n\r\n\t\t\t\t\tconst width = Math.floor(minWidth / minRatio) * ratios[i];\r\n\t\t\t\t\tconst height = Math.floor(minWidth / minRatio);\r\n\t\t\t\t\t\r\n\t\t\t\t\tjQuery(image)\r\n\t\t\t\t\t.css('height', height+'px')\r\n\t\t\t\t\t.css('width', width+'px')\r\n\t\t\t\t\t.css('flex-basis', width+'px');\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tgetSpaceY(gallery) {\r\n\t\t/*\r\n\t\tlet spaceY = 0;\r\n\r\n\t\tconst gridSpacing = jQuery('.drag-gallery').css('--gridSpacing');\r\n\t\tif(gridSpacing.endsWith('rem')) {\r\n\t\t\tspaceY = parseFloat(gridSpacing.replace('rem', '')) * this.getREM();\r\n\t\t} else if(gridSpacing.endsWith('px')) {\r\n\t\t\tspaceY = parseFloat(gridSpacing.replace('px', ''));\r\n\t\t} else {\r\n\t\t\tswitch(jQuery(gallery).css('display')) {\r\n\t\t\t\tcase 'grid':\r\n\t\t\t\t\tspaceY = parseFloat(jQuery(gallery).find('.image').eq(0).css('grid-row-gap').replace('px', ''));\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tspaceY = parseFloat(jQuery(gallery).find('.image').eq(0).css('margin-bottom').replace('px', ''));\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\t*/\r\n\t\t\r\n\t\tlet spaceY = 0;\r\n\t\tif(gallery) {\r\n\t\t\tconst gridSpacing = jQuery(gallery).css('--gridSpacing');\r\n\t\t\t\r\n\t\t\tif(gridSpacing && gridSpacing != '') {\r\n\t\t\t\tspaceY = this.convertCssUnit(gridSpacing, gallery);\r\n\t\t\t}else{\r\n\t\t\t\tspaceY = parseFloat(jQuery(gallery).find('.image').eq(0).css('margin-bottom').replace('px', ''));\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn spaceY;\r\n\t}\r\n\tgetSpaceX(gallery) {\r\n\t\t/*\r\n\t\tlet spaceX = 0;\r\n\r\n\t\tconst gridSpacing = jQuery('.drag-gallery').css('--gridSpacing');\r\n\t\tif(gridSpacing.endsWith('rem')) {\r\n\t\t\tspaceX = parseFloat(gridSpacing.replace('rem', '')) * this.getREM();\r\n\t\t} else if(gridSpacing.endsWith('px')) {\r\n\t\t\tspaceX = parseFloat(gridSpacing.replace('px', ''));\r\n\t\t} else {\r\n\t\t\tswitch(jQuery(gallery).css('display')) {\r\n\t\t\t\tcase 'grid':\r\n\t\t\t\t\tspaceX = parseFloat(jQuery(gallery).find('.image').eq(0).css('grid-column-gap').replace('px', ''));\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tspaceX = parseFloat(jQuery(gallery).find('.image').eq(0).css('margin-right').replace('px', ''));\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\t*/\r\n\t\t\r\n\t\tlet spaceX = 0;\r\n\t\tif(gallery) {\r\n\t\t\tconst gridSpacing = jQuery(gallery).css('--gridSpacing');\r\n\t\t\t\r\n\t\t\tif(gridSpacing && gridSpacing != '') {\r\n\t\t\t\tspaceX = this.convertCssUnit(gridSpacing, gallery);\r\n\t\t\t}else{\r\n\t\t\t\tspaceX = parseFloat(jQuery(gallery).find('.image').eq(0).css('margin-right').replace('px', ''));\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn spaceX;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Convert absolute CSS numerical values to pixels.\r\n\t *\r\n\t * @link https://developer.mozilla.org/en-US/docs/Learn/CSS/Building_blocks/Values_and_units#numbers_lengths_and_percentages\r\n\t *\r\n\t * @param {string} cssValue\r\n\t * @param {null|HTMLElement} target Used for relative units.\r\n\t * @return {*}\r\n\t */\r\n\tconvertCssUnit( cssValue, target ) {\r\n\r\n\t    target = target || document.body;\r\n\r\n\t    const supportedUnits = {\r\n\r\n\t        // Absolute sizes\r\n\t        'px': value => value,\r\n\t        'cm': value => value * 38,\r\n\t        'mm': value => value * 3.8,\r\n\t        'q': value => value * 0.95,\r\n\t        'in': value => value * 96,\r\n\t        'pc': value => value * 16,\r\n\t        'pt': value => value * 1.333333,\r\n\r\n\t        // Relative sizes\r\n\t        'rem': value => value * parseFloat( getComputedStyle( document.documentElement ).fontSize ),\r\n\t        'em': value => value * parseFloat( getComputedStyle( target ).fontSize ),\r\n\t        'vw': value => value / 100 * window.innerWidth,\r\n\t        'vh': value => value / 100 * window.innerHeight,\r\n\r\n\t        // Times\r\n\t        'ms': value => value,\r\n\t        's': value => value * 1000,\r\n\r\n\t        // Angles\r\n\t        'deg': value => value,\r\n\t        'rad': value => value * ( 180 / Math.PI ),\r\n\t        'grad': value => value * ( 180 / 200 ),\r\n\t        'turn': value => value * 360\r\n\r\n\t    };\r\n\r\n\t    // Match positive and negative numbers including decimals with following unit\r\n\t    const pattern = new RegExp( `^([\\-\\+]?(?:\\\\d+(?:\\\\.\\\\d+)?))(${ Object.keys( supportedUnits ).join( '|' ) })$`, 'i' );\r\n\r\n\t    // If is a match, return example: [ \"-2.75rem\", \"-2.75\", \"rem\" ]\r\n\t    const matches = String.prototype.toString.apply( cssValue ).trim().match( pattern );\r\n\r\n\t    if ( matches ) {\r\n\t        const value = Number( matches[ 1 ] );\r\n\t        const unit = matches[ 2 ].toLocaleLowerCase();\r\n\r\n\t        // Sanity check, make sure unit conversion function exists\r\n\t        if ( unit in supportedUnits ) {\r\n\t            return supportedUnits[ unit ]( value );\r\n\t        }\r\n\t    }\r\n\r\n\t    return cssValue;\r\n\r\n\t};\r\n}\r\n\r\ndocument.addEventListener('DOMContentLoaded', function() {\r\n\twindow.dragGallery = new DragGallery();\r\n}, false);"],"names":["DragGallery","constructor","renderRows","bind","waitForImages","imgLoad","jQuery","window","on","document","ready","self","each","index","one","complete","trigger","e","gallery","target","parents","find","removeClass","getREM","parseFloat","css","replace","getRow","row_num","row_image_arr","Array","images","i","length","image","attr","push","rows","in_row","j","row","renderRow","width","parent","innerWidth","getSpaceX","img","naturalHeight","naturalWidth","wrapper","wrapper_rect","getBoundingClientRect","cWidth","ratios","map","ratio","minRatio","Math","min","apply","sumRatios","sumMargins","minWidth","floor","height","getSpaceY","spaceY","gridSpacing","convertCssUnit","eq","spaceX","cssValue","body","supportedUnits","value","getComputedStyle","documentElement","fontSize","innerHeight","PI","pattern","RegExp","Object","keys","join","matches","String","prototype","toString","trim","match","Number","unit","toLocaleLowerCase","addEventListener","dragGallery"],"sourceRoot":""}